try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="512bb782-d66c-49fd-9f30-358d63426323",e._sentryDebugIdIdentifier="sentry-dbid-512bb782-d66c-49fd-9f30-358d63426323")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{19344:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return t(43679)}])},43679:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return N}});var s=t(85893),l=t(67294),o=t(92441),r=t(11163),a=t(88767),d=t(64899),i=t(78430),c=t(50776),u=t(86501);t(52611);var m=t(48069),x=t(5152),h=t.n(x),p=t(2914);function b(e){let{post:n,setPost:t,savePost:o}=e,[r,a]=(0,l.useState)(!1),d=e=>{t(()=>({...n,[e.target.name]:e.target.value}))};return(0,s.jsxs)("div",{id:"post_box",className:"border rounded-b p-1 flex flex-col",children:[(0,s.jsx)("p",{className:"text-2xl my-2",children:"Create Post"}),(0,s.jsx)("label",{required:!0,htmlFor:"name",className:"text-lg my-1",children:"Name"}),(0,s.jsx)("input",{type:"text",onChange:d,className:"p-1 rounded",placeholder:"Enter name...",value:null==n?void 0:n.name,name:"name",id:"name"}),(0,s.jsx)("label",{htmlFor:"subject",className:"text-lg my-1",children:"Subject"}),(0,s.jsx)("input",{type:"text",onChange:d,className:"p-1 rounded",placeholder:"Enter subject...",value:null==n?void 0:n.subject,name:"subject",id:"subject"}),(0,s.jsx)("label",{htmlFor:"content",className:"text-lg my-1",children:"Content"}),(0,s.jsx)("textarea",{className:"w-full px-3 py-2 text-gray-700 border rounded-lg ",rows:"4",id:"content",name:"content",value:null==n?void 0:n.content,onChange:d}),(0,s.jsx)("button",{className:"bg-blue-200 px-3 py-1 rounded inline-block my-2",onClick:o,type:"submit",children:r?(0,s.jsx)(p.fCD,{className:"m-auto h-6 animate-spin"}):"Save Post"})]})}t(47909),h()(()=>Promise.all([t.e(126),t.e(170),t.e(562)]).then(t.bind(t,27170)),{loadableGenerated:{webpack:()=>[27170]},ssr:!1});var g=t(85230),j=t(64749);function f(e){let{posts:n,search:t,setSearch:l,error:o,deletePost:r,toggle:a}=e;return o?(0,s.jsx)("div",{className:"bg-red-300",children:(0,s.jsx)("p",{className:"",children:"Error retrieving posts."})}):n?(0,s.jsxs)("div",{className:"border",children:[(0,s.jsxs)("div",{className:"flex justify-between p-1",children:[(0,s.jsxs)("div",{className:"relative flex w-64",children:[(0,s.jsx)("input",{className:"p-1 w-full border-2 border-gray-300 rounded-l-lg focus:outline-none",type:"search",name:"search",placeholder:"Search",value:t,onChange:e=>l(e.target.value)}),(0,s.jsx)("div",{className:"bg-gray-300 rounded-r-lg p-1 grid",children:(0,s.jsx)(j.Goc,{className:"text-gray-600 h-8 w-8 m-auto"})})]}),(0,s.jsx)("button",{className:"px-3 py-1 border bg-white hover:bg-gray-50 ",onClick:()=>a(),children:"Sort By Date"})]}),n.map(e=>(0,s.jsx)(v,{post:e,deletePost:r},e.id))]}):(0,s.jsx)("div",{className:"bg-red-300",children:(0,s.jsx)("p",{className:"",children:"No Posts..."})})}let v=e=>{let{post:n,deletePost:t}=e;return(0,s.jsxs)("div",{className:"p-1 m-1 border flex flex-col bg-white",children:[(0,s.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,s.jsx)("p",{className:"font-bold",children:n.name}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsxs)("p",{className:"",children:[(0,g.Z)(new Date(n.updatedAt),new Date)," ago"]}),(0,s.jsx)("button",{className:"bg-red-500 py-1 px-3 rounded hover:bg-red-400",onClick:()=>t(n.id,n._version),children:"X"})]})]}),(0,s.jsx)("p",{className:"",children:n.subject}),(0,s.jsx)("p",{className:"",children:n.content})]})};var N=function(){var e;(0,r.useRouter)();let{user:n,setUser:t}=(0,o.Jo)();console.log(n);let[x,h]=(0,l.useState)({subject:"",content:"",name:""}),[p,g]=(0,l.useState)(""),[j,v]=(0,l.useState)(!1),[N,y]=(0,l.useState)(""),w=async()=>{console.log("fetching");try{let e=await d.b.graphql((0,i.wT)(m.aA,{filter:{userId:{eq:n.username}}}));return console.log({result:e}),e=(e=e.data.listPosts.items).filter(e=>null==e._deleted)}catch(e){throw console.log("Error fetching posts"),console.error(e),Error(e)}},{data:P,isLoading:_,isFetching:C,status:A,refetch:I}=(0,a.useQuery)("userposts - ".concat(null==n?void 0:n.username),w,{enabled:!!n}),S=null==P?void 0:P.filter(e=>e.content.toUpperCase().includes(p.toUpperCase())||""===p),k=async(e,n)=>{alert("Are You Sure You Want To Delete This Post?");try{let t=await d.b.graphql((0,i.wT)("\n  mutation DeletePost(\n    $input: DeletePostInput!\n    $condition: ModelPostConditionInput\n  ) {\n    deletePost(input: $input, condition: $condition) {\n      id\n      userId\n      subject\n      content\n      name\n      _version\n      _deleted\n      _lastChangedAt\n      createdAt\n      updatedAt\n    }\n  }\n",{input:{id:e,_version:n}}));console.log({result:t}),u.ZP.success("Post deleted")}catch(e){var t,s;console.log({err:e}),console.log(null===(t=e.errors[0])||void 0===t?void 0:t.message),u.ZP.error("Error deleting post: ".concat(null===(s=e.errors[0])||void 0===s?void 0:s.message))}};return n?(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex flex-col items-center sm:flex-row m-2 sm:items-start",children:[(0,s.jsxs)("div",{className:"bg-white m-2 p-2",children:[n&&(0,s.jsxs)("h2",{className:"font-bold",children:["Welcome, ",null==n?void 0:null===(e=n.attributes)||void 0===e?void 0:e.email]}),(0,s.jsx)("div",{className:"bg-red-200 p-12",children:"My Bio"})]}),(0,s.jsx)("div",{className:"w-11/12 sm:w-3/4 flex flex-col p-2 gap-2",children:(0,s.jsxs)(c.mQ,{children:[(0,s.jsxs)(c.td,{className:"flex gap-3",activeTabClassName:"bg-red-300",children:[(0,s.jsx)(c.OK,{children:"Posts"}),(0,s.jsx)(c.OK,{children:"Settings"}),(0,s.jsx)(c.OK,{children:"Create Post"})]}),(0,s.jsxs)("div",{className:"border border-black min-h-72",children:[(0,s.jsx)(c.x4,{children:(0,s.jsx)(f,{error:"error"===A,posts:S,search:p,setSearch:g,deletePost:k,toggle:()=>{v(!j),P.sort((e,n)=>j?e.createdAt>n.createdAt?-1:1:e.createdAt<n.createdAt?-1:1)}})}),(0,s.jsx)(c.x4,{children:(0,s.jsx)("div",{id:"settings",children:(0,s.jsx)("p",{children:"LOLOLOL"})})}),(0,s.jsx)(c.x4,{children:(0,s.jsx)(b,{post:x,setPost:h,savePost:()=>{console.log(x),console.log(n.username),console.log("Save post"),d.b.graphql((0,i.wT)("\n  mutation CreatePost(\n    $input: CreatePostInput!\n    $condition: ModelPostConditionInput\n  ) {\n    createPost(input: $input, condition: $condition) {\n      id\n      userId\n      subject\n      content\n      name\n      _version\n      _deleted\n      _lastChangedAt\n      createdAt\n      updatedAt\n    }\n  }\n",{input:{...x,userId:n.username}})).then(()=>{console.log("Save Success"),u.ZP.success("Post saved"),h({subject:"",content:"",name:""}),y(""),I()}).catch(e=>{console.log(e),y(e.message)})}})})]})]})})]})}):(0,s.jsx)("p",{className:"text-xl mx-auto mt-12",children:"Login to view profile!"})}},48069:function(e,n,t){"use strict";t.d(n,{aA:function(){return s}});let s="\n  query ListPosts(\n    $filter: ModelPostFilterInput\n    $limit: Int\n    $nextToken: String\n  ) {\n    listPosts(filter: $filter, limit: $limit, nextToken: $nextToken) {\n      items {\n        id\n        userId\n        subject\n        content\n        name\n        _version\n        _deleted\n        _lastChangedAt\n        createdAt\n        updatedAt\n      }\n      nextToken\n      startedAt\n    }\n  }\n"}},function(e){e.O(0,[224,338,888,774,179],function(){return e(e.s=19344)}),_N_E=e.O()}]);