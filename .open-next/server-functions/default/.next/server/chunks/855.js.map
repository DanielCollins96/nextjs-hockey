{"version":3,"file":"855.js","mappings":"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","sources":["webpack://hockey/pages/_document.js","webpack://hockey/sentry-wrapper-module","webpack://hockey/./components/Table.jsx","webpack://hockey/./lib/db.js","webpack://hockey/./lib/queries.js"],"sourcesContent":["import React from 'react';\nimport NextDocument, {Html, Head, Main, NextScript} from 'next/document';\nimport Script from 'next/script'\n\nclass Document extends NextDocument {\n    static async getInitialProps(ctx) {\n        const initialProps = await NextDocument.getInitialProps(ctx);\n        return {...initialProps};\n    }\n\n    render() {\n        return (\n            <Html lang=\"en\">\n                <Head>\n                    <link rel=\"icon\" sizes=\"96x96\" href=\"/images/Hockey-Net.svg\" />\n                    {/* <script async src=\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2056923001767627\"\n     crossOrigin=\"anonymous\"></script> */}\n                </Head>\n                <body className=\"bg-gray-100\">\n                    <Main />\n                    <NextScript />\n                </body>\n            </Html>\n        );\n    }\n}\n\nexport default Document;","import * as serverComponentModule from '__SENTRY_WRAPPING_TARGET_FILE__.cjs';\nexport * from '__SENTRY_WRAPPING_TARGET_FILE__.cjs';\nimport * as Sentry from '@sentry/nextjs';\n\n/*\n * This file is a template for the code which will be substituted when our webpack loader handles non-API files in the\n * `pages/` directory.\n *\n * We use `__SENTRY_WRAPPING_TARGET_FILE__.cjs` as a placeholder for the path to the file being wrapped. Because it's not a real package,\n * this causes both TS and ESLint to complain, hence the pragma comments below.\n */\n\n\nconst userPageModule = serverComponentModule ;\n\nconst pageComponent = userPageModule ? userPageModule.default : undefined;\n\nconst origGetInitialProps = pageComponent ? pageComponent.getInitialProps : undefined;\nconst origGetStaticProps = userPageModule ? userPageModule.getStaticProps : undefined;\nconst origGetServerSideProps = userPageModule ? userPageModule.getServerSideProps : undefined;\n\n// Rollup will aggressively tree-shake what it perceives to be unused properties\n// on objects. Because the key that's used to index into this object (/_document)\n// is replaced during bundling, Rollup can't see that these properties are in fact\n// used. Using `Object.freeze` signals to Rollup that it should not tree-shake\n// this object.\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst getInitialPropsWrappers = Object.freeze({\n  '/_app': Sentry.wrapAppGetInitialPropsWithSentry,\n  '/_document': Sentry.wrapDocumentGetInitialPropsWithSentry,\n  '/_error': Sentry.wrapErrorGetInitialPropsWithSentry,\n});\n\nconst getInitialPropsWrapper = getInitialPropsWrappers['/_document'] || Sentry.wrapGetInitialPropsWithSentry;\n\nif (pageComponent && typeof origGetInitialProps === 'function') {\n  pageComponent.getInitialProps = getInitialPropsWrapper(origGetInitialProps) ;\n}\n\nconst getStaticProps =\n  typeof origGetStaticProps === 'function'\n    ? Sentry.wrapGetStaticPropsWithSentry(origGetStaticProps, '/_document')\n    : undefined;\nconst getServerSideProps =\n  typeof origGetServerSideProps === 'function'\n    ? Sentry.wrapGetServerSidePropsWithSentry(origGetServerSideProps, '/_document')\n    : undefined;\n\nconst pageWrapperTemplate = pageComponent ? Sentry.wrapPageComponentWithSentry(pageComponent ) : pageComponent;\n\nexport { pageWrapperTemplate as default, getServerSideProps, getStaticProps };\n","// import {useTable, useSortBy, useFilters} from \"react-table\";\nimport {\n  useReactTable,\n  flexRender,\n  getRowModel,\n  getCoreRowModel,\n  getPaginationRowModel,\n  getSortedRowModel,\n  SortingState\n\n} from \"@tanstack/react-table\";\nimport { useState } from \"react\";\n\nexport default function ReactTable({columns, data, sortKey = \"season\"}) {\n\n  const [sorting, setSorting] = useState([{\n            id: sortKey,\n            desc: true,\n          },]);\n\n  const table = useReactTable(\n    {\n      columns,\n      data,\n      state: {\n      sorting,\n      },\n      onSortingChange: setSorting,\n      getCoreRowModel: getCoreRowModel(),\n      getSortedRowModel: getSortedRowModel(),\n      // getPaginationRowModel: getPaginationRowModel(),\n    }\n  );\n\n  return (\n    <table\n      className=\"border border-black px-1 m-1 \"\n    >\n   <thead>\n          {table.getHeaderGroups().map(headerGroup => (\n            <tr key={headerGroup.id}>\n              {headerGroup.headers.map(header => {\n                return (\n                  <th className=\"px-1 whitespace-nowrap bg-white border border-blue-600\" key={header.id} colSpan={header.colSpan}>\n                    {header.isPlaceholder ? null : (\n                      <div\n                        {...{\n                          className: header.column.getCanSort()\n                            ? 'cursor-pointer select-none'\n                            : '',\n                          onClick: header.column.getToggleSortingHandler(),\n                        }}\n                      >\n                        {flexRender(\n                          header.column.columnDef.header,\n                          header.getContext()\n                        )}\n                        <span className=\"text-sm\">\n                        {{\n                          asc: ' 🔼',\n                          desc: ' 🔽',\n                        }[header.column.getIsSorted()] ?? null}\n                        </span>\n                      </div>\n                    )}\n                  </th>\n                )\n              })}\n            </tr>\n          ))}\n        </thead>\n      <tbody className=\"\">\n        {table.getRowModel().rows?.map((row, i) => {\n\n          const isNHL = row?.original['league.name'] == 'National Hockey League'\n\n          return (\n            <tr key={row.id} className={`whitespace-nowrap ` + (isNHL ? \"bg-slate-200\" : \"\")}>\n              {row.getVisibleCells().map((cell) => {\n                return (\n                  <td\n                    className=\"border-black border px-1 text-sm\"\n                    key={cell.id}\n                  >\n                    {flexRender(cell.column.columnDef.cell, cell.getContext())}\n                  </td>\n                );\n              })}\n            </tr>\n          );\n        })}\n      </tbody>\n      <tfoot>\n        {table.getFooterGroups().map((footerGroup, idx) => (\n          <tr\n            key={footerGroup.id}\n            className=\"bg-slate-300 py-px text-center font-bold\"\n          >\n            {footerGroup.headers.map((header) => (\n              <td\n                key={header.id}\n                colSpan={header.colSpan}\n                className=\"border-black\"\n              >\n                {header.isPlaceholder\n                  ? null\n                  : flexRender(\n                      header.column.columnDef.footer,\n                      header.getContext()\n                    )}{\" \"}\n              </td>\n            ))}\n          </tr>\n        ))}\n      </tfoot>\n    </table>\n  );\n}\n","import {Pool} from \"pg\";\n\nconst pool = new Pool({\n  user: process.env.DB_USER,\n  password: process.env.DB_PASS,\n  host: process.env.DB_URL,\n  port: process.env.DB_PORT, // Changed from PORT which might conflict with Next.js\n  database: process.env.DB_NAME,\n  // Add some connection management settings\n  max: 30, // maximum number of clients in pool\n  idleTimeoutMillis: 30000,\n  connectionTimeoutMillis: 8000,\n});\n\n// Add error handling\npool.on(\"error\", (err, client) => {\n  console.error(\"Unexpected error on idle client\", err);\n});\n\n// Export the pool directly\nexport default pool;\n","import pool from \"./db.js\";\n\n/**\n * Represents a player in the roster.\n * @typedef {Object} RosterPlayer\n * @property {number} id - The player's ID.\n * @property {string} fullName - The player's full name.\n * @property {string} primaryPosition - The player's primary position.\n * @property {string} seasonId - The season ID.\n * @property {string} teamName - The team name.\n * @property {string} season - The season.\n * @property {number} games - The number of games played.\n * @property {number} goals - The number of goals scored.\n * @property {number} assists - The number of assists.\n * @property {number} points - The total points.\n * @property {number} pim - Penalty minutes.\n * @property {number} plusMinus - The plus/minus rating.\n * Add more properties as needed.\n */\n\n/**\n * Get the roster for a team by ID.\n * @param {number} id - The team's ID.\n * @returns {Promise<RosterPlayer[]>} A promise that resolves to an array of RosterPlayer objects.\n */\nexport async function getRoster(id) {\n  try {\n    const stats = `\n        SELECT p.\"fullName\", p.id, p.\"primaryPosition.code\", f.\"seasonId\", ps.\"team.name\",ps.season, p.\"fullName\",\n        ps.\"stat.games\",ps.\"stat.goals\",ps.\"stat.assists\",ps.\"stat.points\", ps.\"stat.pim\", ps.\"stat.plusMinus\"\n        FROM staging1.team t\n        inner JOIN staging1.franchise f\n        ON t.id = f.\"teamId\"\n        AND \"gameTypeId\" = 2\n        INNER JOIN staging1.player_stats ps\n        ON f.\"seasonId\" = ps.\"season\"\n        AND f.\"teamId\" = ps.\"team.id\"\n        LEFT JOIN staging1.player p\n        ON p.id = ps.\"person.id\"\n        WHERE t.id = $1\n        AND p.id is not null\n        ORDER BY \"seasonId\" desc\n        -- LIMIT 1\n        `;\n\n    // console.log('rosters api getRoster');\n\n    let result = await pool.query(stats, [id]);\n    result = result.rows;\n\n    return result;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n/**\n * Represents a player's statistics for a season.\n * @typedef {Object} PlayerSeasonStats\n * @property {string} season - The season in the format \"YYYY-YY\".\n * @property {string} leagueName - The name of the league.\n * @property {number} teamId - The ID of the team.\n * @property {string} teamName - The name of the team.\n * @property {number} games - The number of games played.\n * @property {number} wins - The number of games won.\n * @property {number} losses - The number of games lost.\n * @property {number} goals - The number of goals scored.\n * @property {number} savePercentage - The save percentage.\n * @property {number} goalAgainstAverage - The goal against average.\n * @property {number} shutouts - The number of shutouts.\n * @property {number} pim - Penalty minutes.\n * @property {number} plusMinus - The plus/minus rating.\n * @property {number} points - The total points.\n * @property {number} assists - The number of assists.\n * Add more properties as needed.\n */\n\n/**\n * Get a player's statistics by their ID.\n * @param {number} id - The player's ID.\n * @param {string} position - The player's position.\n * @returns {Promise<PlayerSeasonStats[]>} A promise that resolves to an array of PlayerSeasonStats objects.\n */\nexport async function getPlayerStats(id, position) {\n  // write a function that queries the player stats database for all stats from the player id\n  // and returns the stats in an array\n  try {\n    // Define the columns to select based on position\n    const columns =\n      position !== \"Goalie\"\n        ? [\n            '\"season\"',\n            '\"league.name\"',\n            '\"team.id\"',\n            '\"team.name\"',\n            '\"stat.games\"',\n            '\"stat.goals\"',\n            '\"stat.pim\"',\n            '\"stat.plusMinus\"',\n            '\"stat.points\"',\n            '\"stat.assists\"',\n          ]\n        : [\n            '\"season\"',\n            '\"league.name\"',\n            '\"team.id\"',\n            '\"team.name\"',\n            '\"stat.games\"',\n            '\"stat.wins\"',\n            '\"stat.losses\"',\n            '\"stat.goals\"',\n            '\"stat.savePercentage\"',\n            '\"stat.goalAgainstAverage\"',\n            '\"stat.shutouts\"',\n            '\"stat.pim\"',\n            '\"stat.plusMinus\"',\n            '\"stat.points\"',\n            '\"stat.assists\"',\n          ];\n\n    // Build the base query\n    let query = `SELECT ${columns.join(\", \")}\n                 FROM staging1.player_stats_new ps\n                 WHERE ps.\"person.id\" = $1`;\n\n    // Run the query\n    let result = await pool.query(query, [id]);\n    return result.rows;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n/**\n * Get a player by ID.\n * @param {number} id - The player's ID.\n * @returns {Promise<Player|null>} A promise that resolves to a Player object or null if not found.\n */\nexport async function getPlayer(id) {\n  try {\n    const stats = `\n        SELECT p.id,\"fullName\",p.\"birthDate\",p.\"birthCountry\"\n\t\t\t ,p.\"primaryPosition.name\"\n\t\t\t ,p.\"primaryNumber\"\n\t\t\t ,p.\"currentAge\"\n\t\t\t ,ARRAY_AGG(d.\"draftYear\") AS draft_seasons,ARRAY_AGG(d.\"overallPickNumber\") AS draft_position\n        FROM staging1.player p\n        LEFT JOIN staging1.drafts d \n        ON d.\"playerId\" = p.id\n        WHERE p.id = $1\n        GROUP BY\n            p.id,\n            p.\"fullName\",\n            p.\"birthDate\",\n            p.\"birthCountry\",\n            p.\"primaryPosition.name\",\n            p.\"primaryNumber\",\n            p.\"currentAge\";\n        `;\n    let result = await pool.query(stats, [id]);\n    result = result.rows;\n    // console.log({resultTst: result});\n    return result;\n  } catch (error) {\n    console.log({tst_er: error});\n  }\n}\n\n/**\n * Get all active player IDs.\n * @returns {Promise<number[]>} A promise that resolves to an array of player IDs.\n */\nexport async function getAllPlayerIds() {\n  try {\n    const stats = `\n        SELECT DISTINCT id\n        FROM staging1.player p\n        WHERE active = true\n        LIMIT 150\n        `;\n\n    let result = await pool.query(stats);\n    result = result.rows;\n\n    return result;\n  } catch (error) {\n    console.log({tst_er: error});\n  }\n}\n\n/**\n * Represents a draft year.\n * @typedef {string} DraftYear\n */\n\n/**\n * Get all distinct draft years.\n * @returns {Promise<DraftYear[]>} A promise that resolves to an array of distinct draft years.\n */\nexport async function getAllDraftYears() {\n  try {\n    const stats = `\n        SELECT DISTINCT \"draftYear\"\n        FROM staging1.drafts\n        ORDER BY \"draftYear\" desc\n        `;\n    let result = await pool.query(stats);\n    result = result.rows;\n\n    return result;\n  } catch (error) {\n    console.log({tst_er: error});\n  }\n}\n\nexport async function getDraft(seasonId) {\n  try {\n    const sql = `\n    select \"playerId\",\"overallPickNumber\",\"pickInRound\",\"roundNumber\",\"playerName\",\"position\",\"amateurLeague\",\"amateurClubName\",\"triCode\",\"birthPlace\",\"draftedByTeamId\"\n    , SUM(\"stat.games\") as games\n    , SUM(ps.\"stat.goals\") as goals\n    , SUM(ps.\"stat.assists\") as assists\n    , SUM(\"stat.points\") as points\n    , SUM(\"stat.pim\") as pim\n    ,CASE\n        WHEN MAX(\"season\") IS NOT NULL THEN\n        CONCAT(SUBSTRING(CAST(MAX(\"season\") AS text), 1, 4), '-', SUBSTRING(CAST(MAX(\"season\") AS text), 5))\n        ELSE\n        CAST(MAX(\"season\") AS text)\n    END AS last_season\n    -- ,*\n    from staging1.drafts d\n    LEFT JOIN staging1.player_stats ps ON d.\"playerId\" = ps.\"person.id\" AND \"league.id\" = 133\n    WHERE \"draftYear\" = $1\n    GROUP BY \"playerId\",\"overallPickNumber\",\"pickInRound\",\"roundNumber\",\"playerName\",\"position\",\"amateurLeague\",\"amateurClubName\",\"triCode\",\"birthPlace\",\"draftedByTeamId\"\n    ORDER BY \"overallPickNumber\" \n\n    `;\n    let result = await pool.query(sql, [seasonId]);\n    result = result.rows;\n    return result;\n  } catch (error) {\n    console.log({tst_er: error});\n    throw error;\n  }\n}\n\nexport async function getTeams() {\n  try {\n    const sql = `\n        SELECT abbreviation, name, id\n        FROM staging1.team\n        ORDER BY name;\n        `;\n    let result = await pool.query(sql);\n    result = result.rows;\n    return result;\n  } catch (error) {\n    console.log({tst_er: error});\n  }\n  // finally {\n  //     client.release()\n  // }\n}\n\nexport async function getTeamIds() {\n  try {\n    const sql = `\n        SELECT id\n        FROM staging1.team\n        `;\n    let result = await pool.query(sql);\n    result = result.rows;\n    return result;\n  } catch (error) {\n    console.log({tst_er: error});\n  }\n}\n\nexport async function getTeamSeasons(id) {\n  try {\n    const sql = `\n        SELECT \"seasonId\", \"wins\", \"losses\", \"points\"\n        ,\"goalsAgainstPerGame\",\"goalsForPerGame\", \"regulationAndOtWins\" as \"row\"\n        , \"pointPct\", \"winsInShootout\"\n        FROM Staging1.team_season\n        WHERE \"teamId\" = $1\n        ORDER BY \"seasonId\" desc \n        LIMIT 8\n        `;\n    let result = await pool.query(sql, [id]);\n    result = result.rows;\n    return result;\n  } catch (error) {\n    console.log({tst_er: error});\n  }\n}\n\nexport async function getTeamSkaters(id) {\n  try {\n    const sql = `\nWITH combined_data AS (\n  SELECT \n    t.id, \n    sk.\"playerId\", \n    sk.season, \n    sk.\"triCode\",\n    CONCAT(sk.\"firstName\", ' ', sk.\"lastName\") AS \"fullName\",\n    SUM(CASE WHEN sk.\"gameType\" = 2 THEN sk.\"gamesPlayed\" ELSE 0 END) AS \"gamesPlayed\",\n    SUM(CASE WHEN sk.\"gameType\" = 3 THEN sk.\"gamesPlayed\" ELSE 0 END) AS \"playoffGamesPlayed\",\n    SUM(CASE WHEN sk.\"gameType\" = 2 THEN sk.\"goals\" ELSE 0 END) AS \"goals\",\n    SUM(CASE WHEN sk.\"gameType\" = 3 THEN sk.\"goals\" ELSE 0 END) AS \"playoffGoals\",\n    SUM(CASE WHEN sk.\"gameType\" = 2 THEN sk.\"assists\" ELSE 0 END) AS \"assists\",\n    SUM(CASE WHEN sk.\"gameType\" = 3 THEN sk.\"assists\" ELSE 0 END) AS \"playoffAssists\",\n    SUM(CASE WHEN sk.\"gameType\" = 2 THEN sk.\"points\" ELSE 0 END) AS \"points\",\n    SUM(CASE WHEN sk.\"gameType\" = 3 THEN sk.\"points\" ELSE 0 END) AS \"playoffPoints\",\n    SUM(CASE WHEN sk.\"gameType\" = 2 THEN sk.\"penaltyMinutes\" ELSE 0 END) AS \"penaltyMinutes\",\n    SUM(CASE WHEN sk.\"gameType\" = 3 THEN sk.\"penaltyMinutes\" ELSE 0 END) AS \"playoffPenaltyMinutes\",\n    SUM(CASE WHEN sk.\"gameType\" = 2 THEN sk.\"plusMinus\" ELSE 0 END) AS \"plusMinus\",\n    SUM(CASE WHEN sk.\"gameType\" = 3 THEN sk.\"plusMinus\" ELSE 0 END) AS \"playoffPlusMinus\",\n    sk.\"positionCode\"\n  FROM newapi.skaters sk\n  JOIN newapi.team t ON sk.\"triCode\" = t.\"triCode\"\n  WHERE t.id = $1\n  GROUP BY t.id, sk.\"playerId\", sk.season, sk.\"triCode\", sk.\"firstName\", sk.\"lastName\", sk.\"positionCode\"\n)\nSELECT DISTINCT \n  id, \n  \"playerId\", \n  season, \n  \"triCode\", \n  \"fullName\", \n  \"gamesPlayed\", \n  \"playoffGamesPlayed\",\n  \"goals\", \n  \"playoffGoals\",\n  \"assists\", \n  \"playoffAssists\",\n  \"points\",\n  \"playoffPoints\",\n  \"penaltyMinutes\", \n  \"playoffPenaltyMinutes\",\n  \"plusMinus\", \n  \"playoffPlusMinus\",\n  \"positionCode\"\nFROM combined_data;\n        `;\n    let result = await pool.query(sql, [id]);\n    result = result.rows;\n    return result;\n  } catch (error) {\n    console.log(error);\n  }\n}\nexport async function getTeamGoalies(id) {\n  try {\n    const sql = `\n    WITH combined_goalie_data AS (\n  SELECT \n    t.id, \n    g.\"playerId\", \n    g.season, \n    g.\"team\", \n    CONCAT(g.\"firstName\", ' ', g.\"lastName\") AS \"fullName\",\n    SUM(CASE WHEN g.\"gameType\" = 2 THEN g.\"gamesPlayed\" ELSE 0 END) AS \"gamesPlayed\",\n    SUM(CASE WHEN g.\"gameType\" = 3 THEN g.\"gamesPlayed\" ELSE 0 END) AS \"playoffGamesPlayed\",\n    SUM(CASE WHEN g.\"gameType\" = 2 THEN g.\"goals\" ELSE 0 END) AS \"goals\",\n    SUM(CASE WHEN g.\"gameType\" = 3 THEN g.\"goals\" ELSE 0 END) AS \"playoffGoals\",\n    SUM(CASE WHEN g.\"gameType\" = 2 THEN g.\"assists\" ELSE 0 END) AS \"assists\",\n    SUM(CASE WHEN g.\"gameType\" = 3 THEN g.\"assists\" ELSE 0 END) AS \"playoffAssists\",\n    SUM(CASE WHEN g.\"gameType\" = 2 THEN g.\"points\" ELSE 0 END) AS \"points\",\n    SUM(CASE WHEN g.\"gameType\" = 3 THEN g.\"points\" ELSE 0 END) AS \"playoffPoints\",\n    SUM(CASE WHEN g.\"gameType\" = 2 THEN g.\"wins\" ELSE 0 END) AS \"wins\",\n    SUM(CASE WHEN g.\"gameType\" = 3 THEN g.\"wins\" ELSE 0 END) AS \"playoffWins\",\n    SUM(CASE WHEN g.\"gameType\" = 2 THEN g.\"losses\" ELSE 0 END) AS \"losses\",\n    SUM(CASE WHEN g.\"gameType\" = 3 THEN g.\"losses\" ELSE 0 END) AS \"playoffLosses\",\n    AVG(CASE WHEN g.\"gameType\" = 2 THEN g.\"goalsAgainstAverage\" END) AS \"goalsAgainstAverage\",\n    AVG(CASE WHEN g.\"gameType\" = 3 THEN g.\"goalsAgainstAverage\" END) AS \"playoffGoalsAgainstAverage\",\n    AVG(CASE WHEN g.\"gameType\" = 2 THEN g.\"savePercentage\" END) AS \"savePercentage\",\n    AVG(CASE WHEN g.\"gameType\" = 3 THEN g.\"savePercentage\" END) AS \"playoffSavePercentage\",\n    SUM(CASE WHEN g.\"gameType\" = 2 THEN g.\"penaltyMinutes\" ELSE 0 END) AS \"penaltyMinutes\",\n    SUM(CASE WHEN g.\"gameType\" = 3 THEN g.\"penaltyMinutes\" ELSE 0 END) AS \"playoffPenaltyMinutes\"\n  FROM newapi.goalies g\n  JOIN newapi.team t ON g.\"team\" = t.\"triCode\"\n  WHERE t.id = $1\n  GROUP BY t.id, g.\"playerId\", g.season, g.team, g.\"firstName\", g.\"lastName\"\n)\nSELECT DISTINCT \n  id, \n  \"playerId\", \n  season, \n  \"team\", \n  \"fullName\", \n  \"gamesPlayed\", \n  \"playoffGamesPlayed\",\n  \"goals\", \n  \"playoffGoals\",\n  \"assists\", \n  \"playoffAssists\",\n  \"points\",\n  \"playoffPoints\",\n  \"wins\", \n  \"playoffWins\",\n  \"losses\", \n  \"playoffLosses\",\n  \"goalsAgainstAverage\", \n  \"playoffGoalsAgainstAverage\",\n  \"savePercentage\", \n  \"playoffSavePercentage\",\n  \"penaltyMinutes\", \n  \"playoffPenaltyMinutes\"\nFROM combined_goalie_data;\n        `;\n    let result = await pool.query(sql, [id]);\n    result = result.rows;\n    return result;\n  } catch (error) {\n    // return a error code\n    console.log({tst_er: error});\n  }\n}\n\nexport async function getPlayoffYears(abbreviation) {\n  try {\n    const sql = `\n        SELECT season\n        FROM staging1.\"team.gametypes\"\n        WHERE 3 = ANY(\"gameTypes\")\n        AND abbreviation = $1\n        `;\n    let result = await pool.query(sql, [abbreviation]);\n    result = result.rows.map((row) => row.season);\n    return result;\n  } catch (error) {\n    console.log({tst_er: error});\n  }\n}\n\nexport async function getPointLeadersBySeason(season = 20222023) {\n  try {\n    const sql = `\n        SELECT     ROW_NUMBER() OVER (ORDER BY ps.\"stat.points\" DESC NULLS LAST, ps.\"stat.goals\" DESC NULLS LAST) AS row_number,\n        p.\"fullName\", p.id, p.\"primaryPosition.code\", ps.\"season\", ps.\"team.name\", ps.\"stat.goals\", ps.\"stat.games\",ps.\"stat.assists\", ps.\"stat.points\", ps.\"team.id\"\n        FROM staging1.player_stats_new ps\n        INNER JOIN staging1.player p\n        ON p.id = ps.\"person.id\" AND ps.season = $1\n        WHERE ps.\"league.id\" = 133\n        ORDER BY ps.\"stat.points\" DESC NULLS LAST,ps.\"stat.goals\" DESC NULLS LAST\n        LIMIT 200\n        `;\n    let result = await pool.query(sql, [season]);\n    result = result.rows;\n    return result;\n  } catch (error) {\n    console.log({tst_er: error});\n  }\n}\n"],"names":["Document","NextDocument","getInitialProps","ctx","render","_jsxs","Html","lang","_jsx","Head","children","link","rel","sizes","href","body","className","Main","NextScript","pageComponent","userPageModule","default","undefined","origGetInitialProps","origGetStaticProps","getStaticProps","origGetServerSideProps","getServerSideProps","getInitialPropsWrapper","getInitialPropsWrappers","freeze","_sentry_nextjs__WEBPACK_IMPORTED_MODULE_4__","wrapAppGetInitialPropsWithSentry","wrapDocumentGetInitialPropsWithSentry","wrapErrorGetInitialPropsWithSentry","wrapGetInitialPropsWithSentry","wrapGetStaticPropsWithSentry","wrapGetServerSidePropsWithSentry","pageWrapperTemplate","wrapPageComponentWithSentry","ReactTable","columns","data","sortKey","sorting","setSorting","useState","id","desc","table","useReactTable","state","onSortingChange","getCoreRowModel","getSortedRowModel","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","jsxs","jsx","thead","getHeaderGroups","map","headerGroup","tr","headers","header","th","colSpan","isPlaceholder","div","column","getCanSort","onClick","getToggleSortingHandler","flexRender","columnDef","getContext","span","asc","getIsSorted","tbody","getRowModel","rows","row","i","isNHL","original","getVisibleCells","td","cell","tfoot","getFooterGroups","footerGroup","idx","footer","pool","Pool","user","process","env","DB_USER","password","DB_PASS","host","DB_URL","port","DB_PORT","database","DB_NAME","max","idleTimeoutMillis","connectionTimeoutMillis","on","err","client","console","error","__WEBPACK_DEFAULT_EXPORT__","getPlayerStats","position","query","join","result","log","getPlayer","stats","tst_er","getAllDraftYears","getDraft","seasonId","sql","getTeams","getTeamIds","getTeamSeasons","getTeamSkaters","getTeamGoalies","getPlayoffYears","abbreviation","season","getPointLeadersBySeason"],"sourceRoot":""}